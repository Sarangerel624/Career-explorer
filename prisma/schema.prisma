// This is your Prisma schema file,
// learn more about it in the docs: https://pris.ly/d/prisma-schema

// Looking for ways to speed up your queries, or scale easily with your serverless or edge functions?
// Try Prisma Accelerate: https://pris.ly/cli/accelerate-init

generator client {
  provider = "prisma-client"
  output   = "../app/generated/prisma"
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

model AiSystem {
  id String @id @default(nanoid())
  systemPrompt String 
  aiResults AiResult[]
  createdAt DateTime @default(now())

} 

model Question {
  id String @id @default(nanoid())
  text String
  order Int 
  category String
  createdAt DateTime @default(now())
  answers UserAnswers[]
}

model User {
  id String @id @default(nanoid())
  username String
  lastName String 
  email String  @unique
  password String
  imgUrl String?
  createdAt DateTime @default(now())
  sessions TestSession[]
  answers UserAnswers[]
  comments Comments[]
  saved   SavedInternships[]
}

model TestSession {
  id String @id @default(nanoid())
  user User @relation(fields: [userId], references: [id])
  userId String
  answers  UserAnswers[]
  aiResult AiResult?
  createdAt DateTime @default(now())
}

model UserAnswers {
  id String @id @default(nanoid())
  user User @relation(fields: [userId], references: [id])
  userId String
  session TestSession @relation(fields: [sessionId], references: [id])
  sessionId String
  question  Question @relation(fields: [questionId], references: [id])
  questionId String
  score Int
}

model AiResult {
  id String @id @default(nanoid())
  session TestSession @relation(fields: [sessionId], references: [id])
  sessionId String @unique
  summary String
  topCareers Json
  personalityType String
  aiSystem AiSystem? @relation(fields: [aiSystemId], references: [id])
  aiSystemId String?
  description String
  relatedCareers Json
  internshipOpportunities Json
  recommendedSkills Json

  createdAt DateTime @default(now())
}


model Comments {
  id        String @id @default(nanoid())
  userId    String
  user      User @relation(fields: [userId], references: [id])
  text String
  username String
  createdAt DateTime @default(now())
}


model Internships {
  id              String   @id @default(nanoid())
  title           String
  company         String
  organizationInfo String?
  jobInfo         String[]
  requirements    String[]
  addnationalInfo String[]
  salary          String? 
  imgUrl          String?
  deadline        String

  savedInterns    SavedInternships[]
}

model SavedInternships {
  userId   String
  internId String
  user     User        @relation(fields: [userId], references: [id])
  intern   Internships @relation(fields: [internId], references: [id])

  @@id([userId, internId])
}



